angular.module("easyTable",[]).directive("ezTable",["$filter",function(a){return{restrict:"A",compile:function(b){var c,d,e,f="<thead><tr>",g='<tr ng-show="showFilters"><th></th>',h=angular.element(b[0].children[0]).find("td");f+='<th><input type="checkbox" ng-model="isToggled" ng-change="toggleAll()"/></th>';for(var i=1;i<h.length-1;i++){if(c=angular.element(h[i]).data("title"),!c)throw new Error('data-title attribute must be specified for column "'+i+'"');d=c.charAt(0).toLowerCase()+c.slice(1),e=angular.element(h[i]).data("field")||d,f+="<th><a ng-click=\"sort('"+e+"')\">"+c+"<span ng-show=\"sortBy == '"+d+'\'" ng-class="{\'caret-up\': asc}" class="caret"></span></a></th>',g+='<th><input class="form-control" ng-model="filters.'+e+'" type="text" ng-change="filter(\''+e+"')\"/></th>"}f+="<th></th></tr>",g+="<th></th></tr>",f+=g+"</thead>",b.prepend(f);var j='<tfoot><tr><td colspan="100%"><input type="checkbox" ng-model="isToggled" ng-change="toggleAll()"/><ul ng-show="pageCount > 1" class="pagination pagination-sm"><li ng-class="{disabled: currentPage == 0}"><a ng-click="prev()">&laquo;</a></li><li ng-class="{active: currentPage == $index}" ng-repeat="page in pages"><a ng-click="setPage($index)">{{ $index + 1 }}</a></li><li ng-class="{disabled: currentPage == (pageCount - 1)}"><a ng-click="next()">&raquo;</a></li></ul><button class="filter-toggle btn btn-sm btn-default pull-right" ng-click="showFilters = !showFilters"><i class="icon-search"></i>Search</button></td></tfoot>';return b.append(j),b.after('<div ng-show="showBatchActions" class="well"><button class="btn btn-sm btn-default" ng-click="batchEdit()"><i class="icon-pencil"></i>Edit</button><button class="btn btn-sm btn-danger" ng-click="batchDelete()"><i class="icon-remove"></i>Delete</button></div>'),b.addClass("table easy-table table-bordered"),function(b,c,d){b._count=parseInt(d.count,10)||10,b.currentPage=0,b.batchAction="",b.asc=!0,b.filters={},b.setPage=function(a){b.currentPage=a,b.items=b.pages[a]},b.calcPages=function(a){var c=[];if(b.filteredItems&&b.filteredItems.length)c=b.filteredItems;else{for(var e in b.filters)break;e||(c=b.$eval(d.ezTable))}b.pageCount=c.length/b._count,b.pages=[];for(var f=0;f<b.pageCount;f++)b.pages[f]=c.slice(f*b._count,f*b._count+b._count);b.setPage(a)},b.toggleAll=function(){b.showBatchActions=!b.showBatchActions,angular.forEach(b.items,function(a,c){b.items[c].selected=b.isToggled})},b.prev=function(){b.currentPage>0&&(b.items=b.pages[b.currentPage-1],b.currentPage--,b.isToggled=!1)},b.next=function(){b.currentPage!==b.pages.length-1&&(b.items=b.pages[b.currentPage+1],b.currentPage++,b.isToggled=!1)},b.sort=function(c){b.asc=!b.asc,b.sortBy=c,b[d.ezTable]=a("orderBy")(b[d.ezTable],c,b.asc),b.calcPages(b.currentPage)},b.filter=function(){b.filteredItems=a("filter")(b[d.ezTable],b.filters),b.calcPages(0)},b.$watch(d.ezTable,function(a){b.showBatchActions=!1,angular.forEach(a,function(a){return a.selected?(b.showBatchActions=!0,void 0):void 0}),b.calcPages(b.currentPage)},!0),b.calcPages(0)}}}}]);